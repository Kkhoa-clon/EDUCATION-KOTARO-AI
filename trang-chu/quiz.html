<!DOCTYPE HTML>
<html lang="vi">
<head>
    <title>Kotaro AI - C√¢u H·ªèi Ng·∫´u Nhi√™n (Ti·∫øng Vi·ªát)</title>
    <meta name="description" content="C√¢u H·ªèi Ng·∫´u Nhi√™n Ti·∫øng Vi·ªát"/>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="../assets/css/main.css" />
    <link rel="stylesheet" href="../assets/css/modern-ui.css" />
    <link rel="stylesheet" href="../assets/css/cuon-trang.css" />
    <link rel="icon" href="../hinh-anh/logo-Photoroom.png" type="image/x-jpg">
    <noscript>
        <link rel="stylesheet" href="../assets/css/noscript.css" />
    </noscript>
</head>
<body class="is-preload landing">
    <div id="page-wrapper">
			<!-- Header -->
			<header id="header">
				<h1 id="logo"><a href="../../index.html">KOTARO AI</a></h1>
				<nav id="nav">
					<ul>
                        <li><a href="https://github.com/Kkhoa-clon/EDUCATION-KOTARO-AI">M√£ Ngu·ªìn M·ªü</a></li>
						<li>
                            <a>Th∆∞ Vi·ªán</a>
							<ul>
								<li><a href="../trang-chu/thu-vien/nghien-cuu.html">Nghi√™n C·ª©u</a></li>
								<li><a href="../trang-chu/thu-vien/ebook.html">Ebook</a></li>
								<li>
									<li><a href="../trang-chu/thu-vien/on-hsg.html">√în Luy·ªán H·ªçc Sinh Gi·ªèi</a></li>
									<li><a href="../trang-chu/thu-vien/vat-ly.html">V·∫≠t L√Ω</a></li>
									<li><a href="../trang-chu/thu-vien/hoa-hoc.html">H√≥a H·ªçc</a></li>
									<li><a href="../trang-chu/thu-vien/sinh-hoc.html">Sinh H·ªçc</a></li>
								</li>
							</ul>
						</li>
						<li><a href="../../chatbot.html">Tr·ª£ L√Ω Sen</a></li>
						<li>
							<a>Thi√™n VƒÉn H·ªçc</a>
							<ul>
								<li><a href="../trang-chu/he-mat-troi.html">H·ªá M·∫∑t Tr·ªùi</a></li>
								<li><a href="../trang-chu/tieu-hanh-tinh.html">Ti·ªÉu H√†nh Tinh</a></li>
								<li><a href="../trang-chu/trai-dat.html">Tr√°i ƒê·∫•t</a></li>
								<li><a href="../trang-chu/hanh-tinh-khac.html">H√†nh Tinh Ngo√†i H·ªá M·∫∑t Tr·ªùi</a></li>
								<li><a href="../trang-chu/image-nasa-interface.html">·∫¢nh Thi√™n VƒÉn Th·ªùi Gian Th·ª±c</a></li>
								<li><a href="../trang-chu/robot-sao-hoa.html">Robot Th√°m Hi·ªÉm Sao H·ªèa</a>
							</ul>
						</li>
						<li><a href="../trang-chu/quiz.html">T·∫°o C√¢u H·ªèi</a></li>
						<li>
							<a>M√¥ Ph·ªèng</a>
							<ul>
								<li>
									<li><a href="../trang-chu/lab/lab2d.html">Th√≠ Nghi·ªám 2D</a></li>
									<li><a href="../trang-chu/he-mat-troi.html">H·ªá M·∫∑t Tr·ªùi 3D</a></li>
									<li><a href="../trang-chu/tieu-hanh-tinh.html">Ti·ªÉu H√†nh Tinh 3D</a></li>
									<li><a href="../trang-chu/trai-dat.html">Tr√°i ƒê·∫•t 3D</a></li>
									<li><a href="../trang-chu/hanh-tinh-khac.html">H√†nh Tinh Ngo√†i H·ªá M·∫∑t Tr·ªùi 3D</a></li>
								</li>
							</ul>
						</li>
					</ul>
				</nav>
			</header>

        <section id="quiz-section" class="modern-section">
            <div class="section-background">
                <div class="bg-overlay"></div>
                <div class="floating-elements">
                    <div class="float-element" data-speed="0.5"></div>
                    <div class="float-element" data-speed="0.8"></div>
                </div>
            </div>
            <div class="container">
                <div class="section-content">
                    <div class="content-left content-wrapper">
                        <div class="section-badge">
                            <span class="badge-icon">üéì</span>
                            <span class="badge-text">Quiz Khoa H·ªçc</span>
                        </div>
                        <h2 class="section-title">
                            <span class="title-line">C√¢u h·ªèi ng·∫´u nhi√™n</span>
                            <span class="title-line highlight">Kotaro AI</span>
                        </h2>
                        <div id="config" class="quiz-config">
                            <label for="amount">S·ªë c√¢u h·ªèi:</label>
                            <select id="amount" class="select-amount">
                                <option value="5">5</option>
                                <option value="10">10</option>
                                <option value="15">15</option>
                                <option value="20">20</option>
                            </select>
                            <label for="category">Ch·ªß ƒë·ªÅ:</label>
                            <select id="category"></select>
                            <label for="difficulty">ƒê·ªô kh√≥:</label>
                            <select id="difficulty">
                                <option value="">T·∫•t c·∫£</option>
                                <option value="easy">D·ªÖ</option>
                                <option value="medium">Trung b√¨nh</option>
                                <option value="hard">Kh√≥</option>
                            </select>
                            <label for="type">Lo·∫°i c√¢u h·ªèi:</label>
                            <select id="type">
                                <option value="">T·∫•t c·∫£</option>
                                <option value="multiple">Nhi·ªÅu l·ª±a ch·ªçn</option>
                                <option value="boolean">ƒê√∫ng/Sai</option>
                            </select>
                            <br>
                            <button class="btn-primary button-3d" onclick="startQuiz()">B·∫Øt ƒë·∫ßu</button>
                            <div id="loading-quiz" class="loading-dots" style="display:none;margin-top:1em;">ƒêang t·∫£i c√¢u h·ªèi...</div>
                        </div>
                        <div id="quiz" style="display:none">
                            <div class="box glass">
                                <div id="quiz-progress" style="margin-bottom:1em;font-weight:600;font-size:1.1em;"></div>
                                <div id="question" class="main-description fade-in-text" style="min-height:60px"></div>
                                <div id="answers" class="cta-buttons answers-grid"></div>
                                <div id="feedback" class="sub-description"></div>
                                <button id="next-btn" class="btn-secondary button-3d" style="display:none" onclick="nextQuestion()">C√¢u ti·∫øp theo</button>
                            </div>
                        </div>
                        <div id="result" style="display:none">
                            <div class="feature-card">
                                <div class="card-icon">üèÜ</div>
                                <div id="score" class="card-text"></div>
                                <button class="btn-primary button-3d" onclick="restartQuiz()">L√†m l·∫°i</button>
                            </div>
                        </div>
                    </div>
                    <div class="content-right">
                        <div class="image-showcase">
                            <div class="main-image">
                                <img src="../hinh-anh/logo-v2-Photoroom.png" alt="Kotaro AI" style="max-width:320px;">
                            </div>
                            <div class="floating-card card-1">
                                <div class="card-icon">ü§ñ</div>
                                <div class="card-text">AI h·ªó tr·ª£ t·∫°o c√¢u h·ªèi theo ch·ªß ƒë·ªÅ</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="../assets/js/jquery.scrolly.min.js"></script>
    <script src="../assets/js/jquery.dropotron.min.js"></script>
    <script src="../assets/js/jquery.scrollex.min.js"></script>
    <script src="../assets/js/browser.min.js"></script>
    <script src="../assets/js/breakpoints.min.js"></script>
    <script src="../assets/js/util.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/cuon-trang.js"></script>
    <script src="../assets/js/modern-ui.js"></script>
    <script>
    // --- Backend logic & d·ªãch t·ª± ƒë·ªông ---
    const scienceCategories = [
        { id: 17, name: "Khoa h·ªçc & T·ª± nhi√™n" },
        { id: 18, name: "Khoa h·ªçc: M√°y t√≠nh" },
        { id: 19, name: "Khoa h·ªçc: To√°n h·ªçc" },
        { id: 27, name: "ƒê·ªông v·∫≠t" },
        { id: 30, name: "Khoa h·ªçc: Thi·∫øt b·ªã" }
    ];
    const otherCategories = [
        { id: 9, name: "Ki·∫øn th·ª©c chung" },
        { id: 10, name: "Gi·∫£i tr√≠: S√°ch" },
        { id: 11, name: "Gi·∫£i tr√≠: Phim ·∫£nh" },
        { id: 12, name: "Gi·∫£i tr√≠: √Çm nh·∫°c" },
        { id: 13, name: "Gi·∫£i tr√≠: Nh·∫°c k·ªãch & S√¢n kh·∫•u" },
        { id: 14, name: "Gi·∫£i tr√≠: Truy·ªÅn h√¨nh" },
        { id: 15, name: "Gi·∫£i tr√≠: Tr√≤ ch∆°i ƒëi·ªán t·ª≠" },
        { id: 16, name: "Gi·∫£i tr√≠: Board Games" },
        { id: 20, name: "Th·∫ßn tho·∫°i" },
        { id: 21, name: "Th·ªÉ thao" },
        { id: 22, name: "ƒê·ªãa l√Ω" },
        { id: 23, name: "L·ªãch s·ª≠" },
        { id: 24, name: "Ch√≠nh tr·ªã" },
        { id: 25, name: "Ngh·ªá thu·∫≠t" },
        { id: 26, name: "Ng∆∞·ªùi n·ªïi ti·∫øng" },
        { id: 28, name: "Ph∆∞∆°ng ti·ªán" },
        { id: 29, name: "Gi·∫£i tr√≠: Truy·ªán tranh" },
        { id: 31, name: "Gi·∫£i tr√≠: Anime & Manga Nh·∫≠t B·∫£n" },
        { id: 32, name: "Gi·∫£i tr√≠: Ho·∫°t h√¨nh & Phim ho·∫°t h√¨nh" }
    ];
    let questions = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let sessionToken = '';

    // Populate categories
    const categorySelect = document.getElementById('category');
    categorySelect.innerHTML = '';
    const optgroupScience = document.createElement('optgroup');
    optgroupScience.label = 'Khoa h·ªçc t·ª± nhi√™n';
    scienceCategories.forEach(cat => {
        const option = document.createElement('option');
        option.value = cat.id;
        option.textContent = cat.name;
        optgroupScience.appendChild(option);
    });
    categorySelect.appendChild(optgroupScience);
    const optgroupOther = document.createElement('optgroup');
    optgroupOther.label = 'Lƒ©nh v·ª±c kh√°c';
    otherCategories.forEach(cat => {
        const option = document.createElement('option');
        option.value = cat.id;
        option.textContent = cat.name;
        optgroupOther.appendChild(option);
    });
    categorySelect.appendChild(optgroupOther);

    // H√†m d·ªãch t·ª± ƒë·ªông qua API (kh√¥ng c·∫ßn key)
    async function translateText(text, targetLang = 'vi') {
        if (!text || text.trim() === '') return '';
        // S·ª≠ d·ª•ng API d·ªãch c√¥ng c·ªông (v√≠ d·ª•: LibreTranslate)
        try {
            const res = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`);
            const data = await res.json();
            return data[0].map(item => item[0]).join('');
        } catch (e) {
            return text; // fallback n·∫øu l·ªói
        }
    }

    // D·ªãch m·∫£ng text
    async function translateArray(arr, targetLang = 'vi') {
        return Promise.all(arr.map(t => translateText(t, targetLang)));
    }

    // Decode HTML entities
    function decodeHtml(html) {
        const txt = document.createElement('textarea');
        txt.innerHTML = html;
        return txt.value;
    }

    // Fetch session token
    async function getSessionToken() {
        try {
            const response = await fetch('https://opentdb.com/api_token.php?command=request');
            const data = await response.json();
            sessionToken = data.token;
        } catch (error) {
            console.error('L·ªói l·∫•y token:', error);
        }
    }

    // Start quiz
    async function startQuiz() {
        document.getElementById('loading-quiz').style.display = 'block';
        await getSessionToken();
        const amount = document.getElementById('amount').value;
        const category = document.getElementById('category').value;
        const difficulty = document.getElementById('difficulty').value;
        const type = document.getElementById('type').value;
        let url = `https://opentdb.com/api.php?amount=${amount}&token=${sessionToken}`;
        if (category) url += `&category=${category}`;
        if (difficulty) url += `&difficulty=${difficulty}`;
        if (type) url += `&type=${type}`;
        try {
            const response = await fetch(url);
            const data = await response.json();
            if (data.response_code === 0) {
                // D·ªãch to√†n b·ªô c√¢u h·ªèi v√† ƒë√°p √°n sang ti·∫øng Vi·ªát
                const rawQuestions = data.results.map(q => ({
                    question: decodeHtml(q.question),
                    correct_answer: decodeHtml(q.correct_answer),
                    incorrect_answers: q.incorrect_answers.map(decodeHtml),
                }));
                // D·ªãch song song
                const translatedQuestions = await Promise.all(rawQuestions.map(async q => {
                    const [questionVi, correctVi, ...incorrectVi] = await translateArray([
                        q.question,
                        q.correct_answer,
                        ...q.incorrect_answers
                    ]);
                    const allAnswers = [correctVi, ...incorrectVi];
                    // Tr·ªôn ƒë√°p √°n
                    allAnswers.sort(() => Math.random() - 0.5);
                    return {
                        question: questionVi,
                        correct_answer: correctVi,
                        incorrect_answers: incorrectVi,
                        all_answers: allAnswers
                    };
                }));
                questions = translatedQuestions;
                currentQuestionIndex = 0;
                score = 0;
                document.getElementById('config').style.display = 'none';
                document.getElementById('quiz').style.display = 'block';
                document.getElementById('loading-quiz').style.display = 'none';
                displayQuestion();
            } else {
                document.getElementById('loading-quiz').style.display = 'none';
                alert('L·ªói l·∫•y c√¢u h·ªèi. Vui l√≤ng th·ª≠ l·∫°i.');
            }
        } catch (error) {
            document.getElementById('loading-quiz').style.display = 'none';
            console.error('L·ªói l·∫•y c√¢u h·ªèi:', error);
            alert('L·ªói l·∫•y c√¢u h·ªèi. Vui l√≤ng th·ª≠ l·∫°i.');
        }
    }

    // Display current question
    function displayQuestion() {
        const question = questions[currentQuestionIndex];
        document.getElementById('question').classList.remove('fade-in-text');
        void document.getElementById('question').offsetWidth; // trigger reflow
        document.getElementById('question').classList.add('fade-in-text');
        document.getElementById('question').textContent = question.question;
        const answersDiv = document.getElementById('answers');
        answersDiv.innerHTML = '';
        question.all_answers.forEach(answer => {
            const button = document.createElement('button');
            button.className = 'btn-secondary button-3d answer';
            button.textContent = answer;
            button.onclick = () => checkAnswer(answer);
            answersDiv.appendChild(button);
        });
        document.getElementById('feedback').textContent = '';
        document.getElementById('next-btn').style.display = 'none';
        // Hi·ªán progress
        document.getElementById('quiz-progress').textContent = `C√¢u ${currentQuestionIndex + 1} / ${questions.length}`;
    }

    // Check user's answer
    function checkAnswer(selectedAnswer) {
        const question = questions[currentQuestionIndex];
        const feedback = document.getElementById('feedback');
        const answerButtons = document.querySelectorAll('.answer');
        answerButtons.forEach(button => {
            button.disabled = true;
            if (button.textContent === question.correct_answer) {
                button.classList.add('correct');
                button.style.background = '#73d239';
                button.style.color = '#fff';
            } else if (button.textContent === selectedAnswer && selectedAnswer !== question.correct_answer) {
                button.classList.add('incorrect');
                button.style.background = '#e74c3c';
                button.style.color = '#fff';
            }
        });
        if (selectedAnswer === question.correct_answer) {
            feedback.innerHTML = '<span style="font-size:1.3em;">üéâ</span> <b>Ch√≠nh x√°c!</b>';
            feedback.style.color = 'green';
            score++;
        } else {
            feedback.innerHTML = `<span style="font-size:1.3em;">ƒê√°p √°n ƒë√∫ng l√†: <b>${question.correct_answer}</b>`;
            feedback.style.color = 'red';
        }
        document.getElementById('next-btn').style.display = 'block';
    }

    // Move to next question
    function nextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < questions.length) {
            displayQuestion();
        } else {
            showResult();
        }
    }

    // Show final result
    function showResult() {
        document.getElementById('quiz').style.display = 'none';
        document.getElementById('result').style.display = 'block';
        document.getElementById('score').innerHTML = `<span style='font-size:2em;'<b>B·∫°n ƒë√∫ng ${score} tr√™n t·ªïng ${questions.length} c√¢u!</b>`;
        // Hi·ªáu ·ª©ng ch√∫c m·ª´ng
        confettiEffect();
    }

    // Restart quiz
    function restartQuiz() {
        document.getElementById('result').style.display = 'none';
        document.getElementById('config').style.display = 'block';
        questions = [];
        currentQuestionIndex = 0;
        score = 0;
    }
    </script>
    <style>
.answers-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1em;
  margin-bottom: 1em;
}
@media (max-width: 600px) {
  .answers-grid {
    grid-template-columns: 1fr;
  }
}
.answer.correct {
  animation: correctPulse 0.5s;
}
.answer.incorrect {
  animation: incorrectShake 0.4s;
}
@keyframes correctPulse {
  0% { transform: scale(1); box-shadow: 0 0 0 #73d239; }
  50% { transform: scale(1.08); box-shadow: 0 0 16px #73d239; }
  100% { transform: scale(1); box-shadow: 0 0 0 #73d239; }
}
@keyframes incorrectShake {
  0% { transform: translateX(0); }
  20% { transform: translateX(-8px); }
  40% { transform: translateX(8px); }
  60% { transform: translateX(-6px); }
  80% { transform: translateX(6px); }
  100% { transform: translateX(0); }
}
.fade-in-text {
  opacity: 0;
  animation: fadeInUp 0.6s forwards;
}
/* L√†m n·ªïi b·∫≠t optgroup trong select */
select#category optgroup[label] {
  font-weight: bold;
  color: #73d239;
  background: #23272f;
}
</style>
</body>
</html> 